HRESULT DdqCreateSession([In] DdqAccessLevel accessLevel, [Out] HDIAGNOSTIC_DATA_QUERY_SESSION* hSession);
HRESULT DdqCloseSession([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession);
HRESULT DdqGetSessionAccessLevel([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Out] DdqAccessLevel* accessLevel);
HRESULT DdqGetDiagnosticDataAccessLevelAllowed([Out] DdqAccessLevel* accessLevel);
HRESULT DdqGetDiagnosticRecordStats([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Const] [In] DIAGNOSTIC_DATA_SEARCH_CRITERIA* searchCriteria, [Out] uint* recordCount, [Out] long* minRowId, [Out] long* maxRowId);
HRESULT DdqGetDiagnosticRecordPayload([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [In] long rowId, [Out] PWSTR* payload);
HRESULT DdqGetDiagnosticRecordLocaleTags([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Const] [In] PWSTR locale, [Out] HDIAGNOSTIC_EVENT_TAG_DESCRIPTION* hTagDescription);
HRESULT DdqFreeDiagnosticRecordLocaleTags([In] HDIAGNOSTIC_EVENT_TAG_DESCRIPTION hTagDescription);
HRESULT DdqGetDiagnosticRecordLocaleTagAtIndex([In] HDIAGNOSTIC_EVENT_TAG_DESCRIPTION hTagDescription, [In] uint index, [Out] DIAGNOSTIC_DATA_EVENT_TAG_DESCRIPTION* tagDescription);
HRESULT DdqGetDiagnosticRecordLocaleTagCount([In] HDIAGNOSTIC_EVENT_TAG_DESCRIPTION hTagDescription, [Out] uint* tagDescriptionCount);
HRESULT DdqGetDiagnosticRecordProducers([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Out] HDIAGNOSTIC_EVENT_PRODUCER_DESCRIPTION* hProducerDescription);
HRESULT DdqFreeDiagnosticRecordProducers([In] HDIAGNOSTIC_EVENT_PRODUCER_DESCRIPTION hProducerDescription);
HRESULT DdqGetDiagnosticRecordProducerAtIndex([In] HDIAGNOSTIC_EVENT_PRODUCER_DESCRIPTION hProducerDescription, [In] uint index, [Out] DIAGNOSTIC_DATA_EVENT_PRODUCER_DESCRIPTION* producerDescription);
HRESULT DdqGetDiagnosticRecordProducerCount([In] HDIAGNOSTIC_EVENT_PRODUCER_DESCRIPTION hProducerDescription, [Out] uint* producerDescriptionCount);
HRESULT DdqGetDiagnosticRecordProducerCategories([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Const] [In] PWSTR producerName, [Out] HDIAGNOSTIC_EVENT_CATEGORY_DESCRIPTION* hCategoryDescription);
HRESULT DdqFreeDiagnosticRecordProducerCategories([In] HDIAGNOSTIC_EVENT_CATEGORY_DESCRIPTION hCategoryDescription);
HRESULT DdqGetDiagnosticRecordCategoryAtIndex([In] HDIAGNOSTIC_EVENT_CATEGORY_DESCRIPTION hCategoryDescription, [In] uint index, [Out] DIAGNOSTIC_DATA_EVENT_CATEGORY_DESCRIPTION* categoryDescription);
HRESULT DdqGetDiagnosticRecordCategoryCount([In] HDIAGNOSTIC_EVENT_CATEGORY_DESCRIPTION hCategoryDescription, [Out] uint* categoryDescriptionCount);
HRESULT DdqIsDiagnosticRecordSampledIn([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Const] [In] Guid* providerGroup, [Const] [In] [Optional] Guid* providerId, [Const] [In] PWSTR providerName, [Const] [In] [Optional] uint* eventId, [Const] [In] PWSTR eventName, [Const] [In] [Optional] uint* eventVersion, [Const] [In] [Optional] ulong* eventKeywords, [Out] BOOL* isSampledIn);
HRESULT DdqGetDiagnosticRecordPage([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [In] DIAGNOSTIC_DATA_SEARCH_CRITERIA* searchCriteria, [In] uint offset, [In] uint pageRecordCount, [In] long baseRowId, [Out] HDIAGNOSTIC_RECORD* hRecord);
HRESULT DdqFreeDiagnosticRecordPage([In] HDIAGNOSTIC_RECORD hRecord);
HRESULT DdqGetDiagnosticRecordAtIndex([In] HDIAGNOSTIC_RECORD hRecord, [In] uint index, [Out] DIAGNOSTIC_DATA_RECORD* record);
HRESULT DdqGetDiagnosticRecordCount([In] HDIAGNOSTIC_RECORD hRecord, [Out] uint* recordCount);
HRESULT DdqGetDiagnosticReportStoreReportCount([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [In] uint reportStoreType, [Out] uint* reportCount);
HRESULT DdqCancelDiagnosticRecordOperation([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession);
HRESULT DdqGetDiagnosticReport([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [In] uint reportStoreType, [Out] HDIAGNOSTIC_REPORT* hReport);
HRESULT DdqFreeDiagnosticReport([In] HDIAGNOSTIC_REPORT hReport);
HRESULT DdqGetDiagnosticReportAtIndex([In] HDIAGNOSTIC_REPORT hReport, [In] uint index, [Out] DIAGNOSTIC_REPORT_DATA* report);
HRESULT DdqGetDiagnosticReportCount([In] HDIAGNOSTIC_REPORT hReport, [Out] uint* reportCount);
HRESULT DdqExtractDiagnosticReport([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [In] uint reportStoreType, [Const] [In] PWSTR reportKey, [Const] [In] PWSTR destinationPath);
HRESULT DdqGetDiagnosticRecordTagDistribution([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [NativeArrayInfo(CountParamIndex = 2)] [In] PWSTR* producerNames, [In] uint producerNameCount, [NativeArrayInfo(CountParamIndex = 4)] [Out] DIAGNOSTIC_DATA_EVENT_TAG_STATS** tagStats, [Out] uint* statCount);
HRESULT DdqGetDiagnosticRecordBinaryDistribution([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [NativeArrayInfo(CountParamIndex = 2)] [In] PWSTR* producerNames, [In] uint producerNameCount, [In] uint topNBinaries, [NativeArrayInfo(CountParamIndex = 5)] [Out] DIAGNOSTIC_DATA_EVENT_BINARY_STATS** binaryStats, [Out] uint* statCount);
HRESULT DdqGetDiagnosticRecordSummary([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Const] [NativeArrayInfo(CountParamIndex = 2)] [In] PWSTR* producerNames, [In] uint producerNameCount, [Out] DIAGNOSTIC_DATA_GENERAL_STATS* generalStats);
HRESULT DdqSetTranscriptConfiguration([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Const] [In] DIAGNOSTIC_DATA_EVENT_TRANSCRIPT_CONFIGURATION* desiredConfig);
HRESULT DdqGetTranscriptConfiguration([In] HDIAGNOSTIC_DATA_QUERY_SESSION hSession, [Out] DIAGNOSTIC_DATA_EVENT_TRANSCRIPT_CONFIGURATION* currentConfig);
